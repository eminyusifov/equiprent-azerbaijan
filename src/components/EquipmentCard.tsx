import React, { useState } from 'react';\nimport { Star, MapPin, Calendar, CheckCircle, XCircle, Heart, Share2 } from 'lucide-react';\nimport { Equipment } from '../types';\nimport { useLanguage } from '../contexts/LanguageContext';\nimport { useFavorites } from '../contexts/FavoritesContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useToast } from './Toast';\nimport { useNavigate } from 'react-router-dom';\nimport OptimizedImage from './OptimizedImage';\n\ninterface EquipmentCardProps {\n  equipment: Equipment;\n  onBook?: (equipment: Equipment) => void;\n}\n\nconst EquipmentCard: React.FC<EquipmentCardProps> = ({ equipment, onBook }) => {\n  const { t, language } = useLanguage();\n  const { favorites, toggleFavorite } = useFavorites();\n  const { isAuthenticated } = useAuth();\n  const { showToast } = useToast();\n  const navigate = useNavigate();\n  const [isImageLoading, setIsImageLoading] = useState(true);\n\n  const isFavorite = favorites.some(fav => fav.equipmentId === equipment.id);\n\n  const getEquipmentName = () => {\n    switch (language) {\n      case 'ru':\n        return equipment.nameRu;\n      case 'az':\n        return equipment.nameAz;\n      default:\n        return equipment.name;\n    }\n  };\n\n  const getEquipmentDescription = () => {\n    switch (language) {\n      case 'ru':\n        return equipment.descriptionRu;\n      case 'az':\n        return equipment.descriptionAz;\n      default:\n        return equipment.description;\n    }\n  };\n\n  const handleBookNow = () => {\n    navigate(`/equipment/${equipment.id}`);\n  };\n\n  const handleCardClick = () => {\n    navigate(`/equipment/${equipment.id}`);\n  };\n\n  const handleFavoriteClick = async (e: React.MouseEvent) => {\n    e.stopPropagation();\n    \n    if (!isAuthenticated) {\n      showToast('info', 'Please login to add items to favorites');\n      navigate('/login');\n      return;\n    }\n\n    try {\n      await toggleFavorite(equipment.id);\n      showToast(\n        'success', \n        isFavorite ? 'Removed from favorites' : 'Added to favorites'\n      );\n    } catch (error) {\n      showToast('error', 'Failed to update favorites');\n    }\n  };\n\n  const handleShareClick = async (e: React.MouseEvent) => {\n    e.stopPropagation();\n    \n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: getEquipmentName(),\n          text: getEquipmentDescription(),\n          url: window.location.origin + `/equipment/${equipment.id}`\n        });\n      } catch (error) {\n        // User cancelled sharing\n      }\n    } else {\n      // Fallback to clipboard\n      try {\n        await navigator.clipboard.writeText(\n          window.location.origin + `/equipment/${equipment.id}`\n        );\n        showToast('success', 'Link copied to clipboard!');\n      } catch (error) {\n        showToast('error', 'Failed to copy link');\n      }\n    }\n  };\n\n  return (\n    <div className=\"bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 overflow-hidden group cursor-pointer\">\n      {/* Image */}\n      <div className=\"relative overflow-hidden\" onClick={handleCardClick}>\n        <OptimizedImage\n          src={equipment.image}\n          alt={getEquipmentName()}\n          className=\"w-full h-48 group-hover:scale-105 transition-transform duration-300\"\n          onLoad={() => setIsImageLoading(false)}\n          onError={() => setIsImageLoading(false)}\n          loading=\"lazy\"\n        />\n        \n        {/* Action Buttons */}\n        <div className=\"absolute top-4 left-4 flex space-x-2\">\n          <button\n            onClick={handleFavoriteClick}\n            className={`p-2 rounded-full backdrop-blur-sm transition-colors duration-200 ${\n              isFavorite \n                ? 'bg-red-500 text-white' \n                : 'bg-white/80 text-gray-700 hover:bg-white'\n            }`}\n          >\n            <Heart className={`w-4 h-4 ${isFavorite ? 'fill-current' : ''}`} />\n          </button>\n          \n          <button\n            onClick={handleShareClick}\n            className=\"p-2 rounded-full bg-white/80 text-gray-700 hover:bg-white backdrop-blur-sm transition-colors duration-200\"\n          >\n            <Share2 className=\"w-4 h-4\" />\n          </button>\n        </div>\n        \n        {/* Availability Badge */}\n        <div className=\"absolute top-4 right-4\">\n          {equipment.available ? (\n            <div className=\"bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold flex items-center space-x-1\">\n              <CheckCircle className=\"w-4 h-4\" />\n              <span>Available</span>\n            </div>\n          ) : (\n            <div className=\"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-semibold flex items-center space-x-1\">\n              <XCircle className=\"w-4 h-4\" />\n              <span>Unavailable</span>\n            </div>\n          )}\n        </div>\n\n        {/* Price Badge */}\n        <div className=\"absolute bottom-4 left-4 bg-blue-600/90 backdrop-blur-sm text-white px-3 py-2 rounded-lg\">\n          <div className=\"text-lg font-bold\">${equipment.pricePerDay}</div>\n          <div className=\"text-xs opacity-90\">per day</div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"p-6\">\n        <div className=\"flex items-start justify-between mb-3\" onClick={handleCardClick}>\n          <h3 className=\"text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors duration-300\">\n            {getEquipmentName()}\n          </h3>\n          \n          {/* Rating */}\n          <div className=\"flex items-center space-x-1\">\n            <Star className=\"w-4 h-4 fill-yellow-400 text-yellow-400\" />\n            <span className=\"text-sm font-semibold text-gray-700\">{equipment.rating}</span>\n            <span className=\"text-sm text-gray-500\">({equipment.reviewCount})</span>\n          </div>\n        </div>\n\n        <p className=\"text-gray-600 mb-4 line-clamp-2\" onClick={handleCardClick}>\n          {getEquipmentDescription()}\n        </p>\n\n        {/* Location */}\n        <div className=\"flex items-center space-x-2 text-gray-500 mb-4\" onClick={handleCardClick}>\n          <MapPin className=\"w-4 h-4\" />\n          <span className=\"text-sm\">{equipment.location}</span>\n        </div>\n\n        {/* Features */}\n        <div className=\"flex flex-wrap gap-2 mb-6\" onClick={handleCardClick}>\n          {equipment.features.slice(0, 2).map((feature, index) => (\n            <span\n              key={index}\n              className=\"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium\"\n            >\n              {feature}\n            </span>\n          ))}\n          {equipment.features.length > 2 && (\n            <span className=\"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium\">\n              +{equipment.features.length - 2} more\n            </span>\n          )}\n        </div>\n\n        {/* Pricing Options with discount badges */}\n        <div className=\"grid grid-cols-3 gap-2 mb-6 text-center\" onClick={handleCardClick}>\n          <div className=\"bg-gray-50 rounded-lg p-2\">\n            <div className=\"text-sm font-semibold text-gray-900\">${equipment.pricePerDay}</div>\n            <div className=\"text-xs text-gray-500\">Daily</div>\n          </div>\n          <div className=\"bg-gray-50 rounded-lg p-2 relative\">\n            <div className=\"text-sm font-semibold text-gray-900\">${equipment.pricePerWeek}</div>\n            <div className=\"text-xs text-gray-500\">Weekly</div>\n            {equipment.pricePerWeek < equipment.pricePerDay * 7 && (\n              <div className=\"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full\">\n                Save {Math.round((1 - equipment.pricePerWeek / (equipment.pricePerDay * 7)) * 100)}%\n              </div>\n            )}\n          </div>\n          <div className=\"bg-gray-50 rounded-lg p-2 relative\">\n            <div className=\"text-sm font-semibold text-gray-900\">${equipment.pricePerMonth}</div>\n            <div className=\"text-xs text-gray-500\">Monthly</div>\n            {equipment.pricePerMonth < equipment.pricePerDay * 30 && (\n              <div className=\"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full\">\n                Save {Math.round((1 - equipment.pricePerMonth / (equipment.pricePerDay * 30)) * 100)}%\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Book Button */}\n        <div className=\"flex space-x-2\">\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              navigate(`/equipment/${equipment.id}`);\n            }}\n            className=\"flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-200 border-2 border-blue-600 text-blue-600 hover:bg-blue-50\"\n          >\n            View Details\n          </button>\n          \n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              handleBookNow();\n            }}\n            disabled={!equipment.available}\n            className={`flex-2 py-3 px-6 rounded-lg font-semibold transition-all duration-200 transform hover:scale-105 ${\n              equipment.available\n                ? 'bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg hover:shadow-xl'\n                : 'bg-gray-300 text-gray-500 cursor-not-allowed'\n            }`}\n          >\n            {equipment.available ? 'Book Now' : 'Unavailable'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EquipmentCard;\n"