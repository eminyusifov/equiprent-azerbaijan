import React, { Component, ErrorInfo, ReactNode } from 'react';\nimport { AlertTriangle, RefreshCw, Home } from 'lucide-react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n  errorInfo?: ErrorInfo;\n}\n\nclass ErrorBoundary extends Component<Props, State> {\n  public state: State = {\n    hasError: false\n  };\n\n  public static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error('Uncaught error:', error, errorInfo);\n    this.setState({ error, errorInfo });\n  }\n\n  private handleRetry = () => {\n    this.setState({ hasError: false, error: undefined, errorInfo: undefined });\n  };\n\n  private handleGoHome = () => {\n    window.location.href = '/';\n  };\n\n  public render() {\n    if (this.state.hasError) {\n      // Если предоставлен кастомный fallback компонент\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div className=\"min-h-screen flex items-center justify-center bg-gray-50 px-4\">\n          <div className=\"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center\">\n            <AlertTriangle className=\"h-16 w-16 text-red-500 mx-auto mb-4\" />\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">\n              Oops! Something went wrong\n            </h2>\n            <p className=\"text-gray-600 mb-6\">\n              We're sorry, but something unexpected happened. Please try again or go back to the homepage.\n            </p>\n            \n            {/* В режиме разработки показываем детали ошибки */}\n            {process.env.NODE_ENV === 'development' && this.state.error && (\n              <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded text-left\">\n                <h3 className=\"font-semibold text-red-800 mb-2\">Error Details:</h3>\n                <p className=\"text-sm text-red-700 font-mono\">\n                  {this.state.error.message}\n                </p>\n                {this.state.errorInfo && (\n                  <details className=\"mt-2\">\n                    <summary className=\"text-sm text-red-700 cursor-pointer\">\n                      Stack trace\n                    </summary>\n                    <pre className=\"text-xs text-red-600 mt-2 whitespace-pre-wrap\">\n                      {this.state.errorInfo.componentStack}\n                    </pre>\n                  </details>\n                )}\n              </div>\n            )}\n            \n            <div className=\"flex flex-col sm:flex-row gap-3\">\n              <button\n                onClick={this.handleRetry}\n                className=\"flex-1 inline-flex items-center justify-center space-x-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors\"\n              >\n                <RefreshCw className=\"h-5 w-5\" />\n                <span>Try Again</span>\n              </button>\n              <button\n                onClick={this.handleGoHome}\n                className=\"flex-1 inline-flex items-center justify-center space-x-2 bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors\"\n              >\n                <Home className=\"h-5 w-5\" />\n                <span>Go Home</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;\n\n// HOC для использования ErrorBoundary с функциональными компонентами\nexport const withErrorBoundary = <P extends object>(\n  Component: React.ComponentType<P>,\n  fallback?: ReactNode\n) => {\n  const WrappedComponent = (props: P) => (\n    <ErrorBoundary fallback={fallback}>\n      <Component {...props} />\n    </ErrorBoundary>\n  );\n\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`;\n  \n  return WrappedComponent;\n};\n"